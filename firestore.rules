rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    function isadmin(){
      return get(/databases/$(database)/documents/Members/$(request.auth.uid)).data.admin == true;
    }
    match /Members/{id}{
      allow write: if (request.auth.uid == request.resource.data.id && request.resource.data.admin == false) ||
      isadmin();
      allow read: if request.auth != null
    }
    match /Events/{events}{
    	allow write: if isadmin();
      allow read: if request.auth != null;
    }
    match /Event/{event}{
    	allow write: if isadmin();
      allow read;
    }
    match /LoginFields/{fields}{
    	allow write: if false;
      allow read;
    }
    match /Posts/{post}{
    	allow read: if request.auth != null;
      allow create: if (request.auth != null && request.auth.uid == request.resource.data.id);
      allow update: if request.auth != null && (request.auth.uid == post.id || isadmin());
      
    }
    match /Resources/{resource}{
    	allow read;
    }
  }
}
