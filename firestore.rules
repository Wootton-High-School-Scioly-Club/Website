rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    function isadmin(){
      return request.auth.token.admin == true;
    }
    match /Members/{id}{
      allow create: if true;
      allow update: if (request.auth.uid == request.resource.data.id) ||
      isadmin();
      allow read;
    }
    match /Events/{events}{
    	allow write: if isadmin();
      allow read: if request.auth != null;
    }
    match /Event/{event}{
    	allow write: if isadmin();
      allow read;
    }
    match /LoginFields/{fields}{
    	allow write: if false;
      allow read;
    }
    match /Posts/{post}{
    	allow read: if request.auth != null;
      allow create: if (request.auth != null && request.auth.uid == request.resource.data.id);
      allow update: if request.auth != null && (request.auth.uid == post.id || isadmin());

    }
    match /Resources/{resource}{
    	allow read;
    }
  }
}
